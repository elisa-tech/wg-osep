digraph G {
node [shape=box width=2 height=0.5 fontname=arial fontsize=18
      style=filled fillcolor=white]
graph [splines=ortho ranksep=0.9 nodesep=1]
edge [fontname=arial fontsize=12]
layout=dot; overlap=false; compound=true;

{rank=same
    Developer [width=4]
    Architect [label="System architect"] }

Compiler [width=4]
Build [label="System construction" width=6]

subgraph cluster_0 { style=dotted margin=15 bgcolor=lightgrey
                     label=<<i>System</i>> labelloc=b
                     fontname="arial" fontsize=18
    Manager [label="System/Service Manager (systemd)" width=6.5]
    { rank=same
        Application [label="Process X (with safety function)" width=4.5]
        Other [label="Other process"] }
    LibC [label="C Library (GLibC)" width=6]
    Stack [label="X Call stack" width=3]
    Interrupt [label="Interrupt source"]
    Kernel [width=4]
    KSub [label="Kernel subroutine"]
    }

Developer -> Build [taillabel="\rBuild system  \rBuild component  \r" weight=2]
Developer -> Compiler [dir=back style=dashed headlabel="\r(Errors,  \lwarnings)  \r\r"]
Architect -> Build [taillabel="\rSpecify default stack params  \rSpecify launch params  \r"]

Build -> Manager [taillabel="\rConfigure  \llaunch params  \r"]
Build-> Kernel [taillabel="\rConfigure  \ldefault  \lstack params  \l"]
Build -> Compiler [taillabel="\rCompile  \lcomponent  \r" weight=3]

Compiler -> Manager [lhead=cluster_0 taillabel="\rImplement stack  \lmemory operations  \r"]

Manager -> Application [taillabel="\rStart  \r" weight=4]
Manager -> Other [taillabel="\rStart  \r"]
Manager -> LibC [taillabel="\r(Calls)  \r"]
Manager -> LibC [dir=back style=dashed]

Application -> Stack [taillabel="\rPush  \rPop  \r"]
Application -> Stack [dir=back style=dashed]
Application -> LibC [taillabel="\r(Calls)  \r" weight=4]
Application -> LibC [dir=back style=dashed weight=4]

LibC -> Stack [taillabel="\rPush  \rPop  \r"]
LibC -> Stack [dir=back style=dashed]

Other -> LibC [taillabel="\r(Calls)  \r"]
Other -> LibC [dir=back style=dashed]

Stack -> LibC [style=invis]

LibC -> Kernel [taillabel="\r(Syscalls)  \r"]
LibC -> Kernel [dir=back style=dashed]

Kernel -> KSub [taillabel="\r(Calls)  \r"]
Kernel -> KSub [dir=back style=dashed]
Kernel-> Interrupt[dir=back style=dashed headlabel="\r(IRQ)  \r\r" weight=2]
}
